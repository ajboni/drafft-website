"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3977],{62099:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"reference/state-and-simulation-lifecycle","title":"State & Simulation Lifecycle","description":"Drafft separates authored data from simulated state.","source":"@site/docs/02-reference/02__state-and-simulation-lifecycle.mdx","sourceDirName":"02-reference","slug":"/reference/state-and-simulation-lifecycle","permalink":"/docs/reference/state-and-simulation-lifecycle","draft":false,"unlisted":false,"editUrl":"https://github.com/ajboni/drafft-website/edit/main/docs/02-reference/02__state-and-simulation-lifecycle.mdx","tags":[{"inline":true,"label":"scripting","permalink":"/docs/tags/scripting"},{"inline":true,"label":"state","permalink":"/docs/tags/state"},{"inline":true,"label":"simulation","permalink":"/docs/tags/simulation"},{"inline":true,"label":"mental-model","permalink":"/docs/tags/mental-model"},{"inline":true,"label":"authoring","permalink":"/docs/tags/authoring"}],"version":"current","sidebarPosition":2,"frontMatter":{"title":"State & Simulation Lifecycle","tags":["scripting","state","simulation","mental-model","authoring"]},"sidebar":"tutorialSidebar","previous":{"title":"Drafft Scripting Syntax","permalink":"/docs/reference/drafft-scripting-syntax"},"next":{"title":"Dialogue Tree Editor","permalink":"/docs/reference/dialogue-tree-editor"}}');var r=i(74848),t=i(28453);const l={title:"State & Simulation Lifecycle",tags:["scripting","state","simulation","mental-model","authoring"]},a="State & Simulation Lifecycle",c={},d=[{value:"Core Concepts",id:"core-concepts",level:2},{value:"Defaults (Authored State)",id:"defaults-authored-state",level:3},{value:"Live Scenario (Simulated State)",id:"live-scenario-simulated-state",level:3},{value:"State Lifecycle",id:"state-lifecycle",level:2},{value:"1. Initialization",id:"1-initialization",level:3},{value:"2. Script Execution",id:"2-script-execution",level:3},{value:"3. Continuity Across Scripts",id:"3-continuity-across-scripts",level:3},{value:"4. Resetting State",id:"4-resetting-state",level:3},{value:"Write to Live Scenario Toggle",id:"write-to-live-scenario-toggle",level:2},{value:"Enabled (default)",id:"enabled-default",level:3},{value:"Disabled (ephemeral simulation)",id:"disabled-ephemeral-simulation",level:3},{value:"Divergence Detection",id:"divergence-detection",level:2},{value:"When Does Divergence Occur?",id:"when-does-divergence-occur",level:3},{value:"Visual Indicator",id:"visual-indicator",level:3},{value:"Divergence vs Changes",id:"divergence-vs-changes",level:3},{value:"Scenarios as Diffs",id:"scenarios-as-diffs",level:2},{value:"Why Diffs?",id:"why-diffs",level:3},{value:"Example",id:"example",level:3},{value:"Current Scope",id:"current-scope",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"Live Scenario Buttons",id:"live-scenario-buttons",level:2},{value:"Save as New Scenario",id:"save-as-new-scenario",level:3},{value:"Update Source Scenario",id:"update-source-scenario",level:3},{value:"Discard Changes",id:"discard-changes",level:3},{value:"Reset to Defaults",id:"reset-to-defaults",level:3},{value:"State Resolution in Scripts",id:"state-resolution-in-scripts",level:2},{value:"Resolution Order (Three-Tier Fallback)",id:"resolution-order-three-tier-fallback",level:3},{value:"Accessing Defaults Explicitly",id:"accessing-defaults-explicitly",level:3},{value:"Context-Aware Resolution",id:"context-aware-resolution",level:3},{value:"What Scripts Can and Cannot Do",id:"what-scripts-can-and-cannot-do",level:2},{value:"Scripts Can",id:"scripts-can",level:3},{value:"Scripts Cannot",id:"scripts-cannot",level:3},{value:"Relationship to Export and Runtime",id:"relationship-to-export-and-runtime",level:2},{value:"Why This Model Exists",id:"why-this-model-exists",level:2},{value:"Summary",id:"summary",level:2}];function o(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"state--simulation-lifecycle",children:"State & Simulation Lifecycle"})}),"\n",(0,r.jsxs)(n.p,{children:["Drafft separates ",(0,r.jsx)(n.strong,{children:"authored data"})," from ",(0,r.jsx)(n.strong,{children:"simulated state"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"This distinction is essential to understanding how scripts behave, how the Dialogue Simulator works, and how to debug narrative flow without coupling logic to export or runtime."}),"\n",(0,r.jsxs)(n.p,{children:["This page describes how ",(0,r.jsx)(n.strong,{children:"state exists, changes, and resets"})," during authoring."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"defaults-authored-state",children:"Defaults (Authored State)"}),"\n",(0,r.jsx)(n.p,{children:"Defaults are the values you author in Drafft documents:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Variables"}),"\n",(0,r.jsx)(n.li,{children:"Quest properties"}),"\n",(0,r.jsx)(n.li,{children:"Actor properties"}),"\n",(0,r.jsx)(n.li,{children:"Items, flags, and other design data"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Defaults represent ",(0,r.jsx)(n.strong,{children:"authorial intent"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"They are:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Stable"}),"\n",(0,r.jsx)(n.li,{children:"Version-controlled"}),"\n",(0,r.jsx)(n.li,{children:"Exported as part of the project"}),"\n",(0,r.jsx)(n.li,{children:"Never mutated by scripts"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"live-scenario-simulated-state",children:"Live Scenario (Simulated State)"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Live Scenario"})," represents the ",(0,r.jsx)(n.strong,{children:"current simulated world state while authoring"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"It is derived from defaults and then modified by script execution or manual data entry."}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Think of the Live Scenario as:\n",(0,r.jsx)(n.em,{children:"\u201cWhat is true right now, based on what I\u2019ve simulated so far?\u201d"})]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"state-lifecycle",children:"State Lifecycle"}),"\n",(0,r.jsx)(n.h3,{id:"1-initialization",children:"1. Initialization"}),"\n",(0,r.jsx)(n.p,{children:"When a project or editor session starts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Live Scenario = Defaults\n"})}),"\n",(0,r.jsx)(n.p,{children:"At this point, no simulation has occurred."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"2-script-execution",children:"2. Script Execution"}),"\n",(0,r.jsx)(n.p,{children:"When a script is simulated:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:'@set variables.aries.mood = "angry"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The script runs ",(0,r.jsx)(n.strong,{children:"against the Live Scenario"})]}),"\n",(0,r.jsx)(n.li,{children:"Mutations apply immediately"}),"\n",(0,r.jsx)(n.li,{children:"Subsequent scripts see the updated state"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:"::Narrator:: Aries looks ${variables.aries.mood}.\n"})}),"\n",(0,r.jsx)(n.p,{children:"After simulation, this resolves to:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Aries looks angry.\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"3-continuity-across-scripts",children:"3. Continuity Across Scripts"}),"\n",(0,r.jsxs)(n.p,{children:["The Live Scenario ",(0,r.jsx)(n.strong,{children:"persists across scripts"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"If Script A sets:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:'@set variables.aries.mood = "angry"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Then Script B, authored later, will observe:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:'${variables.aries.mood} \u2192 "angry"\n'})}),"\n",(0,r.jsx)(n.p,{children:"This matches natural author expectations during narrative development."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"4-resetting-state",children:"4. Resetting State"}),"\n",(0,r.jsx)(n.p,{children:"At any point, the Live Scenario can be reset . This clears all simulated mutations and restores the authored baseline."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"write-to-live-scenario-toggle",children:"Write to Live Scenario Toggle"}),"\n",(0,r.jsxs)(n.p,{children:["By default, simulation ",(0,r.jsx)(n.strong,{children:"writes to the Live Scenario"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"However, Drafft provides a toggle:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Write to Live Scenario"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"enabled-default",children:"Enabled (default)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Script mutations persist"}),"\n",(0,r.jsx)(n.li,{children:"State carries across simulations"}),"\n",(0,r.jsx)(n.li,{children:"Ideal for narrative authoring and iteration"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"disabled-ephemeral-simulation",children:"Disabled (ephemeral simulation)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Scripts run against a temporary copy of state"}),"\n",(0,r.jsx)(n.li,{children:"All changes are discarded after execution"}),"\n",(0,r.jsx)(n.li,{children:"Live Scenario remains unchanged"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This mode is useful for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Testing edge cases"}),"\n",(0,r.jsx)(n.li,{children:"Previewing alternative branches"}),"\n",(0,r.jsx)(n.li,{children:"Verifying conditional logic without affecting ongoing work"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"divergence-detection",children:"Divergence Detection"}),"\n",(0,r.jsxs)(n.p,{children:["The Live Scenario compares itself against the currently loaded scenario to detect divergence. This comparison is ",(0,r.jsx)(n.strong,{children:"snapshot-based"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"when-does-divergence-occur",children:"When Does Divergence Occur?"}),"\n",(0,r.jsx)(n.p,{children:"Divergence is only detected when:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"A scenario is loaded into the Live Scenario"}),"\n",(0,r.jsx)(n.li,{children:"You modify values (manually via the Variables Inspector or via script execution)"}),"\n",(0,r.jsxs)(n.li,{children:["The modified values differ from the ",(0,r.jsx)(n.strong,{children:"loaded scenario's snapshot"})]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Divergence ",(0,r.jsx)(n.strong,{children:"only exists when a scenario is loaded"}),". If no scenario is active, there is no divergence to track."]})}),"\n",(0,r.jsx)(n.h3,{id:"visual-indicator",children:"Visual Indicator"}),"\n",(0,r.jsx)(n.p,{children:"When divergence is detected:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A divergence indicator (an asterisk) appears in the UI"}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:'"Update Source Scenario"'})," button becomes enabled"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:'"Discard Changes"'})," button becomes enabled"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"divergence-vs-changes",children:"Divergence vs Changes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Divergence"}),": Live state differs from a loaded scenario's snapshot"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No divergence + scenario loaded"}),": Live matches the loaded scenario exactly (clean state)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Changes with no scenario loaded"}),": Not tracked as divergence; considered a new scenario if saved"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"scenarios-as-diffs",children:"Scenarios as Diffs"}),"\n",(0,r.jsxs)(n.p,{children:["While the Live Scenario is ephemeral during authoring, you can ",(0,r.jsx)(n.strong,{children:"save and restore snapshots"})," of it using scenarios."]}),"\n",(0,r.jsxs)(n.admonition,{type:"important",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Scenarios are diffs, not complete snapshots."})}),(0,r.jsxs)(n.p,{children:["A scenario stores ",(0,r.jsx)(n.em,{children:"only the values that differ from defaults"}),", not the entire state. This is similar to a patch file."]})]}),"\n",(0,r.jsx)(n.h3,{id:"why-diffs",children:"Why Diffs?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Smaller files"}),": Only overridden values are stored"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clearer intent"}),": You see exactly which defaults were modified"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Better version control"}),": Diffs are easier to review and merge"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"If your defaults contain:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "player": {\n    "level": 1,\n    "hp": 100,\n    "status": "healthy"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["And during authoring you change only ",(0,r.jsx)(n.code,{children:"status"})," to ",(0,r.jsx)(n.code,{children:'"sad"'}),", the saved scenario will contain:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "player": {\n    "status": "sad"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["When you load this scenario, it overwrites only the ",(0,r.jsx)(n.code,{children:"status"})," field while preserving ",(0,r.jsx)(n.code,{children:"level: 1"})," and ",(0,r.jsx)(n.code,{children:"hp: 100"})," from defaults."]}),"\n",(0,r.jsx)(n.h3,{id:"current-scope",children:"Current Scope"}),"\n",(0,r.jsxs)(n.p,{children:["Scenarios currently save ",(0,r.jsx)(n.strong,{children:"Variable"})," state only. Support for additional collections (Actors, Quests, Items, etc.) is planned for future releases."]}),"\n",(0,r.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'"Chapter 2 \u2013 After Library"'}),"\n",(0,r.jsx)(n.li,{children:'"Boss Fight Setup"'}),"\n",(0,r.jsx)(n.li,{children:"Bug reproduction states"}),"\n",(0,r.jsx)(n.li,{children:"QA handoff"}),"\n",(0,r.jsx)(n.li,{children:"Testing alternative narrative branches"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Scenarios:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Do not affect defaults"}),"\n",(0,r.jsx)(n.li,{children:"Can be loaded and restored into the Live Scenario"}),"\n",(0,r.jsx)(n.li,{children:"Are optional, not required for normal authoring"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"live-scenario-buttons",children:"Live Scenario Buttons"}),"\n",(0,r.jsx)(n.p,{children:"The Live Scenario page provides several buttons for managing scenarios. Here's what each does:"}),"\n",(0,r.jsx)(n.h3,{id:"save-as-new-scenario",children:"Save as New Scenario"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Button"}),": \ud83d\udcbe Save as New Scenario"]}),"\n",(0,r.jsx)(n.p,{children:"Serializes the current Live Scenario state and creates a new scenario document."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What it saves"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Compares live state against defaults"}),"\n",(0,r.jsx)(n.li,{children:"Stores only the values that differ"}),"\n",(0,r.jsx)(n.li,{children:"Creates a new scenario document with a user-provided name"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"After reaching a meaningful narrative checkpoint"}),"\n",(0,r.jsx)(n.li,{children:"Before testing alternative branches"}),"\n",(0,r.jsx)(n.li,{children:"To create reproducible QA states"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"You can also open the Live Scenario page by right clicking on the current scenario in the status bar."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"update-source-scenario",children:"Update Source Scenario"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Button"}),": \ud83d\udd04 Update Source Scenario (enabled only when divergence is detected)"]}),"\n",(0,r.jsx)(n.p,{children:"Serializes current live divergence and updates the source scenario document in the editor."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Compares current live state against the loaded scenario's snapshot"}),"\n",(0,r.jsx)(n.li,{children:"Serializes only the differences (the new diff)"}),"\n",(0,r.jsx)(n.li,{children:"Opens the scenario document in the editor tab (or focuses existing tab)"}),"\n",(0,r.jsx)(n.li,{children:"Updates the editor buffer with the new content"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Waits for you to explicitly save"})," (preserves review/approval workflow)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Multi-user safety"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Checks if scenario is locked by another user"}),"\n",(0,r.jsx)(n.li,{children:"Prevents automatic overwrites"}),"\n",(0,r.jsx)(n.li,{children:"User remains in editor before committing changes"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You've made changes during scripting that should become the new baseline"}),"\n",(0,r.jsx)(n.li,{children:"You want to refine an existing scenario incrementally"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"discard-changes",children:"Discard Changes"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Button"}),": \ud83d\udd04 Discard Changes (enabled only when divergence is detected)"]}),"\n",(0,r.jsx)(n.p,{children:"Reloads the original loaded scenario back into the Live Scenario, discarding all modifications."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Clears all live state"}),"\n",(0,r.jsx)(n.li,{children:"Reapplies the loaded scenario's snapshot"}),"\n",(0,r.jsx)(n.li,{children:"Removes the divergence indicator"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You made experimental changes and want to return to the scenario baseline"}),"\n",(0,r.jsx)(n.li,{children:"You want to reset to a known state without reloading from disk"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"reset-to-defaults",children:"Reset to Defaults"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Button"}),": \ud83d\udd04 Reset to Defaults"]}),"\n",(0,r.jsx)(n.p,{children:"Clears all live state and unloads any active scenario, returning to the pure authored defaults."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Clears all live variable values"}),"\n",(0,r.jsx)(n.li,{children:"Clears the loaded scenario snapshot"}),"\n",(0,r.jsx)(n.li,{children:"Unsets the active scenario"}),"\n",(0,r.jsx)(n.li,{children:"Removes all divergence tracking"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:'Differs from "Discard Changes" because'}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"It removes the scenario context entirely"}),"\n",(0,r.jsx)(n.li,{children:"You start fresh from authored defaults, not a scenario snapshot"}),"\n",(0,r.jsx)(n.li,{children:"Useful for starting a new simulation from baseline"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Starting a new test or simulation"}),"\n",(0,r.jsx)(n.li,{children:"Clearing all runtime state after a session"}),"\n",(0,r.jsx)(n.li,{children:"Testing default-only behavior without scenario modifications"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"state-resolution-in-scripts",children:"State Resolution in Scripts"}),"\n",(0,r.jsx)(n.p,{children:"All state access follows the same resolution rule:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"<collection>.<_sid>.<property>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:"variables.player.courage\nvariables.player.inventory[0].name\n\n// other collections will be implemented in future updates, but the same resolution applies:\nactors.Aries.mood\nquest.forestTrial.completed\n"})}),"\n",(0,r.jsx)(n.h3,{id:"resolution-order-three-tier-fallback",children:"Resolution Order (Three-Tier Fallback)"}),"\n",(0,r.jsx)(n.p,{children:"When you access a value, Drafft resolves it in this order:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Live Scenario"})," \u2190 Used first if available"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Defaults"})," \u2190 Used if no live value exists"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Undefined"})," \u2190 If neither exists"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:"// If live has modified this value:\n${variables.player.mood} \u2192 resolves to live value\n\n// If live doesn't have this, falls back to defaults:\n${variables.player.level} \u2192 resolves to default value\n\n// If neither exists:\n${variables.nonexistent} \u2192 undefined\n"})}),"\n",(0,r.jsx)(n.h3,{id:"accessing-defaults-explicitly",children:"Accessing Defaults Explicitly"}),"\n",(0,r.jsxs)(n.p,{children:["To access authored values and bypass any live modifications, use the ",(0,r.jsx)(n.code,{children:"defaults"})," root:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-uaf",children:"${defaults.variables.player.courage} \u2192 always uses authored default\n"})}),"\n",(0,r.jsx)(n.p,{children:"This is useful for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Debugging state divergence"}),"\n",(0,r.jsx)(n.li,{children:"Checking what the original value was"}),"\n",(0,r.jsx)(n.li,{children:"Exporting context-free content"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"context-aware-resolution",children:"Context-Aware Resolution"}),"\n",(0,r.jsx)(n.p,{children:"Dependending on context, resolution behavior changes:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Context"}),(0,r.jsx)(n.th,{children:"Resolution"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Authoring"}),(0,r.jsx)(n.td,{children:"Live \u2192 Defaults"}),(0,r.jsx)(n.td,{children:"Script simulation, testing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Export"}),(0,r.jsx)(n.td,{children:"Defaults only"}),(0,r.jsx)(n.td,{children:"Pure narrative content"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Runtime"}),(0,r.jsx)(n.td,{children:"Engine-defined (script-bound)"}),(0,r.jsx)(n.td,{children:"Your target platform"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["This separation ensures ",(0,r.jsx)(n.strong,{children:"your exports remain pure and unaffected by simulation state"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"what-scripts-can-and-cannot-do",children:"What Scripts Can and Cannot Do"}),"\n",(0,r.jsx)(n.h3,{id:"scripts-can",children:"Scripts Can"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Read Live Scenario state"}),"\n",(0,r.jsxs)(n.li,{children:["Mutate Live Scenario via ",(0,r.jsx)(n.code,{children:"@set"})]}),"\n",(0,r.jsx)(n.li,{children:"Drive conditional structure during simulation"}),"\n",(0,r.jsx)(n.li,{children:"Be replayed deterministically"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scripts-cannot",children:"Scripts Cannot"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mutate defaults"}),"\n",(0,r.jsx)(n.li,{children:"Persist changes automatically"}),"\n",(0,r.jsx)(n.li,{children:"Execute engine logic"}),"\n",(0,r.jsx)(n.li,{children:"Implicitly affect export output"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"relationship-to-export-and-runtime",children:"Relationship to Export and Runtime"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Context"}),(0,r.jsx)(n.th,{children:"Behavior"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Export"}),(0,r.jsx)(n.td,{children:"State is not evaluated or mutated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Simulation"}),(0,r.jsx)(n.td,{children:"Uses Live Scenario"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Runtime"}),(0,r.jsx)(n.td,{children:"Engine defines state behavior"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["The Dialogue Simulator (aka Script Player) uses the ",(0,r.jsx)(n.strong,{children:"same rules"})," described on this page."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-this-model-exists",children:"Why This Model Exists"}),"\n",(0,r.jsx)(n.p,{children:"This design ensures:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Predictable authoring"}),"\n",(0,r.jsx)(n.li,{children:"Clear separation of intent vs outcome"}),"\n",(0,r.jsx)(n.li,{children:"Debuggable narrative flow"}),"\n",(0,r.jsx)(n.li,{children:"Engine-agnostic exports"}),"\n",(0,r.jsx)(n.li,{children:"No hidden side effects"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Defaults define what ",(0,r.jsx)(n.em,{children:"should"})," exist"]}),"\n",(0,r.jsxs)(n.li,{children:["Live Scenario defines what ",(0,r.jsx)(n.em,{children:"currently"})," exists"]}),"\n",(0,r.jsx)(n.li,{children:"Scripts mutate Live Scenario"}),"\n",(0,r.jsx)(n.li,{children:"Live Scenario can be reset or saved"}),"\n",(0,r.jsx)(n.li,{children:"Export remains pure and context-free"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(96540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);