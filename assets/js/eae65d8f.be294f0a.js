"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4577],{43272:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"reference/exporting/migration_guide","title":"Drafft  Migration Guide - V1 to V2 Schema","description":"A comprehensive guide to understanding and migrating from Drafft Legacy (V1) to the current Drafft V2 schema structure, including breaking changes and code examples.","source":"@site/docs/02-reference/99_exporting/03__migration_guide.mdx","sourceDirName":"02-reference/99_exporting","slug":"/reference/exporting/migration_guide","permalink":"/docs/reference/exporting/migration_guide","draft":false,"unlisted":false,"editUrl":"https://github.com/ajboni/drafft-website/edit/main/docs/02-reference/99_exporting/03__migration_guide.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Drafft  Migration Guide - V1 to V2 Schema","description":"A comprehensive guide to understanding and migrating from Drafft Legacy (V1) to the current Drafft V2 schema structure, including breaking changes and code examples."},"sidebar":"tutorialSidebar","previous":{"title":"Drafft Legacy (v1) Output Schema","permalink":"/docs/reference/exporting/v1_exporting_schema"},"next":{"title":"Troubleshooting","permalink":"/docs/troubleshooting/"}}');var r=s(74848),c=s(28453);const i={title:"Drafft  Migration Guide - V1 to V2 Schema",description:"A comprehensive guide to understanding and migrating from Drafft Legacy (V1) to the current Drafft V2 schema structure, including breaking changes and code examples."},d="Migration Guide: V1 to V2 Schema",o={},l=[{value:"Breaking Changes Overview",id:"breaking-changes-overview",level:2},{value:"Common Changes Across All Collections",id:"common-changes-across-all-collections",level:2},{value:"Folders Collection Changes",id:"folders-collection-changes",level:2},{value:"GDD Collection Changes",id:"gdd-collection-changes",level:2},{value:"Scripts Collection Changes",id:"scripts-collection-changes",level:2},{value:"Code Example: Accessing Script Content",id:"code-example-accessing-script-content",level:3},{value:"Dialogues Collection Changes",id:"dialogues-collection-changes",level:2},{value:"Code Example: Accessing Dialogue Nodes",id:"code-example-accessing-dialogue-nodes",level:3},{value:"Actors Collection Changes",id:"actors-collection-changes",level:2},{value:"Code Example: Accessing Actor Properties",id:"code-example-accessing-actor-properties",level:3},{value:"Grids Collection Changes",id:"grids-collection-changes",level:2},{value:"Kanban Collection Changes",id:"kanban-collection-changes",level:2},{value:"Other Changes",id:"other-changes",level:2},{value:"Conclusion",id:"conclusion",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"migration-guide-v1-to-v2-schema",children:"Migration Guide: V1 to V2 Schema"})}),"\n",(0,r.jsx)(n.p,{children:"This document outlines the key differences between Drafft V1 and V2 schemas to help you migrate your projects and understand the structural changes."}),"\n",(0,r.jsx)(n.h2,{id:"breaking-changes-overview",children:"Breaking Changes Overview"}),"\n",(0,r.jsx)(n.p,{children:"The migration from V1 to V2 includes several notable changes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Content Structure Changes"}),": The ",(0,r.jsx)(n.code,{children:"content"})," property now contains type-specific structured data rather than direct values"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dialogue Structure Changes"}),": Complete overhaul of dialogue representation from ",(0,r.jsx)(n.code,{children:"graph"})," to ",(0,r.jsx)(n.code,{children:"tree"})," structure"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"New Properties"}),": Additional metadata fields across all collections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Collection-specific Properties"}),": More specialized properties for each collection type"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-changes-across-all-collections",children:"Common Changes Across All Collections"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Content Structure"}),(0,r.jsx)(n.td,{children:"Direct properties"}),(0,r.jsxs)(n.td,{children:["Nested in ",(0,r.jsx)(n.code,{children:"content"})," object"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": All content access requires ",(0,r.jsx)(n.code,{children:".content"})," prefix"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Comments"}),(0,r.jsx)(n.td,{children:"Not standardized"}),(0,r.jsxs)(n.td,{children:["Standardized ",(0,r.jsx)(n.code,{children:"comments"})," field (for future use)"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Enhancement"}),": Consistent commenting across objects"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"folders-collection-changes",children:"Folders Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Children"}),(0,r.jsx)(n.td,{children:"Array of ID strings"}),(0,r.jsxs)(n.td,{children:["Array of objects with ",(0,r.jsx)(n.code,{children:"_id"})," property"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Children structure changed from simple IDs to objects"]})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"gdd-collection-changes",children:"GDD Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GDD Content"}),(0,r.jsx)(n.td,{children:"Direct property"}),(0,r.jsxs)(n.td,{children:["Nested as ",(0,r.jsx)(n.code,{children:"content.gdd"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": GDD content access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GDD Format"}),(0,r.jsx)(n.td,{children:"MArkdown and HTML"}),(0,r.jsx)(n.td,{children:"Markdown Only"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": HTML support dropped"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"scripts-collection-changes",children:"Scripts Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Script Content"}),(0,r.jsx)(n.td,{children:"Direct property"}),(0,r.jsxs)(n.td,{children:["Nested as ",(0,r.jsx)(n.code,{children:"content.script"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Script content access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Editor Mode"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"scriptEditorMode"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"editorMode"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Property renamed"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"code-example-accessing-script-content",children:"Code Example: Accessing Script Content"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// V1\nconst scriptContent = script.content;\n\n// V2\nconst scriptContent = script.content.script;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dialogues-collection-changes",children:"Dialogues Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Structure"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"graph"})," with ",(0,r.jsx)(n.code,{children:"nodes"})," and ",(0,r.jsx)(n.code,{children:"links"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"tree"})," with ",(0,r.jsx)(n.code,{children:"nodes"})," and ",(0,r.jsx)(n.code,{children:"edges"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Complete restructuring of dialogue format"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Positioning"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"x"}),"/",(0,r.jsx)(n.code,{children:"y"})," coordinates"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"position.x"}),"/",(0,r.jsx)(n.code,{children:"position.y"})," objects"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Node positioning access changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Connection Model"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"links"})," and ",(0,r.jsx)(n.code,{children:"ports"})]}),(0,r.jsxs)(n.td,{children:["Simplified ",(0,r.jsx)(n.code,{children:"edges"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Connection model completely changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Node Properties"}),(0,r.jsx)(n.td,{children:"Various direct properties"}),(0,r.jsxs)(n.td,{children:["Restructured under ",(0,r.jsx)(n.code,{children:"data"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Node property access paths changed"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"code-example-accessing-dialogue-nodes",children:"Code Example: Accessing Dialogue Nodes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// V1\nconst nodes = dialogue.graph.nodes;\nconst nodePosition = { x: nodes[0].x, y: nodes[0].y };\n\n// V2\nconst nodes = dialogue.content.tree.nodes;\nconst nodePosition = nodes[0].position;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"actors-collection-changes",children:"Actors Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Content"}),(0,r.jsx)(n.td,{children:"Direct property"}),(0,r.jsxs)(n.td,{children:["All props below are now nested under ",(0,r.jsx)(n.code,{children:"content"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Actor content access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Bio"}),(0,r.jsxs)(n.td,{children:["Direct ",(0,r.jsx)(n.code,{children:"bio"})," property (HTML)"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"content.bio"})," (Markdown)"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Format change from HTML to Markdown"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Expressions"}),(0,r.jsx)(n.td,{children:"Direct property"}),(0,r.jsxs)(n.td,{children:["Nested as ",(0,r.jsx)(n.code,{children:"content.expressions"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Expressions access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Properties"}),(0,r.jsxs)(n.td,{children:["Direct ",(0,r.jsx)(n.code,{children:"properties"})," property"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"content.properties"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Properties access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Attachments"}),(0,r.jsxs)(n.td,{children:["Stored with document as ",(0,r.jsx)(n.code,{children:"_attachments"})]}),(0,r.jsx)(n.td,{children:"Removed (using drafft:// protocol)"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Attachment storage mechanism changed"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"code-example-accessing-actor-properties",children:"Code Example: Accessing Actor Properties"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// V1\nconst actorProperties = JSON.parse(actor.properties); // Direct access to properties\n\n// V2\nconst rawProperties = actor.content.properties; // Available under content. Could be parsed manually\n"})}),"\n",(0,r.jsx)(n.h2,{id:"grids-collection-changes",children:"Grids Collection Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Columns"}),(0,r.jsxs)(n.td,{children:["Direct ",(0,r.jsx)(n.code,{children:"columns"})," property"]}),(0,r.jsxs)(n.td,{children:["Nested as ",(0,r.jsx)(n.code,{children:"content.columns"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Columns access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Data"}),(0,r.jsxs)(n.td,{children:["Direct ",(0,r.jsx)(n.code,{children:"data"})," property"]}),(0,r.jsxs)(n.td,{children:["Nested as ",(0,r.jsx)(n.code,{children:"content.data"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Data access path changed"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Data Structure"}),(0,r.jsx)(n.td,{children:"Less detailed"}),(0,r.jsx)(n.td,{children:"Comprehensive cell/column model"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Enhancement"}),": More powerful grid capabilities"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Styling"}),(0,r.jsx)(n.td,{children:"Not standardized"}),(0,r.jsxs)(n.td,{children:["Detailed ",(0,r.jsx)(n.code,{children:"style"})," object"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"New Feature"}),": Cell-level styling support"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Worksheet Metadata"}),(0,r.jsx)(n.td,{children:"Not present"}),(0,r.jsxs)(n.td,{children:["Added ",(0,r.jsx)(n.code,{children:"worksheetId"})," and ",(0,r.jsx)(n.code,{children:"worksheetName"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Enhancement"}),": Better worksheet identification (For future use)"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"kanban-collection-changes",children:"Kanban Collection Changes"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Under development"})}),"\n",(0,r.jsx)(n.h2,{id:"other-changes",children:"Other Changes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Change"}),(0,r.jsx)(n.th,{children:"V1 Schema"}),(0,r.jsx)(n.th,{children:"V2 Schema"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Hotkeys Collection"}),(0,r.jsx)(n.td,{children:"Present"}),(0,r.jsx)(n.td,{children:"Removed"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"Breaking Change"}),": Hotkeys collection no longer exists"]})]})})]}),"\n",(0,r.jsx)(n.h1,{id:"migration-helper",children:"Migration Helper"}),"\n",(0,r.jsxs)(n.p,{children:["Check ",(0,r.jsx)(n.a,{href:"https://github.com/ajboni/drafft-examples/blob/main/migrate-to-v2.js",children:"this script"})," for a reference implementation (under development)"]}),"\n",(0,r.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,r.jsx)(n.p,{children:"The migration from V1 to V2 schema represents a significant evolution in the data model, offering more structure, better organization, and enhanced capabilities. While the changes do introduce breaking changes, the resulting schema is more robust and future-proof."}),"\n",(0,r.jsx)(n.p,{children:"The most critical changes are in the content access patterns and the dialogue structure. By following this migration guide, you should be able to successfully update your application to support the V2 schema while understanding the architectural improvements it brings."})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>d});var t=s(96540);const r={},c=t.createContext(r);function i(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);